(()=>{"use strict";var e=function(e,t){e.classList.add(t),e.disabled=!0},t=function(t,n,r){!function(e){return e.some((function(e){return!e.validity.valid}))}(t)?function(e,t){e.classList.remove(t),e.disabled=!1}(n,r):e(n,r)},n=document.querySelector(".cards"),r=document.querySelector(".popup_image-view"),o=r.querySelector(".popup__image"),c=r.querySelector(".popup__image-caption"),u=document.querySelector("#card-template").content.querySelector(".card"),a=function(e,t){var n=u.cloneNode(!0),a=n.querySelector(".card__image");return n.querySelector(".card__name").textContent=e,a.src=t,a.alt=e,n.querySelector(".card__like").addEventListener("click",(function(e){e.target.classList.toggle("card__like_active")})),n.querySelector(".card__delete").addEventListener("click",(function(e){e.target.closest(".card").remove()})),a.addEventListener("click",(function(){o.src=t,o.alt=e,c.textContent=e,b(r)})),n},i=function(e){n.prepend(e)},s=document.querySelector(".popup_edit-profile"),p=s.querySelector(".popup__input_data_name"),l=s.querySelector(".popup__input_data_description"),d=document.querySelector(".profile__info"),_=d.querySelector(".profile__name"),f=document.querySelector(".profile__avatar"),v=d.querySelector(".profile__description"),m=document.querySelector(".popup_add-card"),y=m.querySelector(".popup__input_data_name"),S=m.querySelector(".popup__input_data_link"),q=m.querySelector(".popup__submit-button"),L=function(e){var t=e.target.classList.contains("popup__figure-container");e.target.classList.contains("popup__container")||t||h(e.target)},E=function(e){if("Escape"===e.key){var t=document.querySelector(".popup_opened");h(t)}},b=function(e){e.classList.add("popup_opened"),e.addEventListener("click",L),document.addEventListener("keydown",E)},h=function(e){e.classList.remove("popup_opened"),e.removeEventListener("click",L),document.removeEventListener("keydown",E)};document.querySelector(".profile__edit-button").addEventListener("click",(function(){p.value=_.textContent,l.value=v.textContent,b(s)})),document.querySelector(".profile__add-button").addEventListener("click",(function(){return b(m)})),document.querySelectorAll(".popup__close-button").forEach((function(e){return e.addEventListener("click",(function(e){h(e.target.closest(".popup"))}))})),s.querySelector(".popup__edit-area").addEventListener("submit",(function(e){e.preventDefault(),_.textContent=p.value,v.textContent=l.value,h(e.target.closest(".popup"))})),m.querySelector(".popup__edit-area").addEventListener("submit",(function(t){t.preventDefault();var n=a(y.value,S.value);i(n),h(t.target.closest(".popup")),t.target.reset(),e(q,"popup__submit-button_inactive")}));var k,C="5374e37d-a100-45c2-9054-8042aa4bada1",g="https://mesto.nomoreparties.co/v1/".concat("plus-cohort-12"),x="".concat(g,"/users/me"),A="".concat(g,"/cards");fetch(A,{headers:{authorization:C}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка получения карточек ".concat(e.status))})).then((function(e){e.sort((function(e,t){return t.createdAt-e.createdAt})),e.forEach((function(e){var t;(t=e.link,new Promise((function(e,n){var r=new Image;r.src=t,r.onload=e,r.onerror=n}))).then((function(){return a(e.name,e.link)})).then(i).catch((function(){return console.error("Изображение ".concat(e.name," по ссылке ").concat(e.link," не доступно."))}))}))})),fetch(x,{headers:{authorization:C}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка получения информации о пользователе ".concat(e.status))})).then((function(e){var t,n,r;e._id,t=e.avatar,n=e.name,r=e.about,_.textContent=n,v.textContent=r,f.src=t})),k={formSelector:".popup__edit-area",inputSelector:".popup__input",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__submit-button_inactive",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_visible"},Array.from(document.querySelectorAll(k.formSelector)).forEach((function(e){e.addEventListener("submit",(function(e){return e.preventDefault()})),function(e,n){var r=Array.from(e.querySelectorAll(n.inputSelector)),o=e.querySelector(n.submitButtonSelector);t(r,o,n.inactiveButtonClass),r.forEach((function(c){return c.addEventListener("input",(function(){!function(e,t,n){t.validity.valid?function(e,t,n){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n.inputErrorClass),r.classList.remove(n.errorClass),r.textContent=""}(e,t,n):function(e,t,n,r){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.add(r.inputErrorClass),o.textContent=n,o.classList.add(r.errorClass)}(e,t,t.validationMessage,n)}(e,c,n),t(r,o,n.inactiveButtonClass)}))}))}(e,k)}))})();